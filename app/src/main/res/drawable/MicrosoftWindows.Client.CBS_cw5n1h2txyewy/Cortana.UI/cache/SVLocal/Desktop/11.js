var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),WSB;(function(n){var t="QSCH",u=function(r){function u(t){var u=r.call(this,"QSCH")||this;return u._lightweightStorage=t,u._lastTypedQuery=new i,(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.mockLastQuery)&&u._lastTypedQuery.setQuery(n.TestHookUrlParameters.mockLastQuery),n.Host.bindDismissed(function(n){n&&n.queryToFetch&&u._lastTypedQuery.setQuery(n.fullPartialQuery)}),u}return __extends(u,r),u.prototype.getName=function(){return"QuickSearchSuggestionsDataProvider"},u.prototype.fetch=function(i,r){var s=this,f;if(i.enabledDataSources[t]){var u={},e=n.ScopeConfig[n.Scope.Web]&&n.ScopeConfig[n.Scope.Web].prefixes?n.ScopeConfig[n.Scope.Web].prefixes[0]:null,o=n.Host.getLanguage().toLowerCase();n.config.resumeSearch&&(u.resumeSearchQuery=this._lastTypedQuery.getQuery(),u.resumeSearchRemoveAction=function(){s._lastTypedQuery.setQuery("");n.Host.refreshCurrentPane()});n.shouldEnableQuickSearches(o)&&(f=[],u.quickAnswers=n.getQuickAnswersTranslatedSuggestions(o,this._lightweightStorage),u.quickAnswers.forEach(function(n){e?f.push(e.toLowerCase()+": "+n.query):f.push(n.query)}),u.resumeSearchQuery&&n.contains(f,u.resumeSearchQuery)&&(delete u.resumeSearchQuery,delete u.resumeSearchRemoveAction));r(t,u,undefined)}},u}(n.JsonDataProvider),i,r;n.QuickSearchSuggestionsDataProvider=u;i=function(){function t(){this.LastTypedQueryTTLms=6e5}return t.prototype.getQuery=function(){var t=n.getCurrentTime();return this._lastTypedQueryTimeStamp&&t-this._lastTypedQueryTimeStamp<this.LastTypedQueryTTLms?this._lastTypedQuery:(this._lastTypedQuery=null,this._lastTypedQueryTimeStamp=null,null)},t.prototype.setQuery=function(t){this._lastTypedQuery=t;this._lastTypedQueryTimeStamp=n.getCurrentTime()},t}();r=function(){function t(n){this._navigationHelper=n}return t.prototype.parse=function(t,i,r,u,f,e){var v=this,l=[],y=n.ScopeConfig[n.Scope.Web]&&n.ScopeConfig[n.Scope.Web].prefixes?n.ScopeConfig[n.Scope.Web].prefixes[0]:null,o,p,c,a,w;if(u&&u.resumeSearchQuery){var h="RSSG",s=n.createSuggestion(t,n.Host.getLocString("RedoLastSearch"),null,{type:2,content:"&#xE81C"},h,u.resumeSearchQuery,n.InstrumentedItem.createInstrumentedItemForReformulation(i,h),998,i,n.localDataSourceMayContainPII(r)),b={verb:"RemoveFromDeviceHistory",displayName:n.Host.getLocString("RemoveFromDeviceHistory"),executeSync:u.resumeSearchRemoveAction,icon:{content:"&#xE711",type:2}};s.tooltip=n.Host.getLocString("RedoYourLastSearchTooltip",u.resumeSearchQuery);n.setExtraVerbs(s,function(){return[b]},!1);s.click=function(){n.Host.reformulate(u.resumeSearchQuery);n.Host.setFocusInSearchBox(null,h+".click")};s.reactKey=h+u.resumeSearchQuery;l.push(s)}if(u&&u.quickAnswers)for(o="QSSG",p=function(u){var e=n.config.quickSearchToMsnMarkets[n.getCurrentLanguage()]&&u.msnUrl,s=(u.type===2||u.type===1)&&n.config.enableShopSH1,h=n.config.quickSearchToEdge||e||s,f=n.createSuggestion(t,u.text?u.text:u.query,null,n.config.quickAnswerWeb?{type:2,content:"&#xE721"}:u.icon,o,u.query,h?n.InstrumentedItem.createInstrumentedItem(i,o):n.InstrumentedItem.createInstrumentedItemForReformulation(i,o),h?e?20:s?15:0:998,i,n.localDataSourceMayContainPII(r));f.tooltip=e?u.msnTooltip:u.tooltip;f.click=function(){var c;if(e)n.Host.launchUri(u.msnUrl);else if(s&&f.handoffType===15){var l="",i=n.Host.getLanguage().toLowerCase(),a="entrypoint=wsb&setmkt="+i,r=f.query.toLowerCase(),p=n.encodeQueryParameter(r);l=(i=="en-au"||i=="en-ca"||i=="en-gb"||i=="en-us")&&r==="valentine's day gifts"?"/shop/valentines-day?":r==="geschenke zum valentinstag"?"/shop/valentins-tag?":r==="cadeaux pour la saint-valentin"?"/shop/saintvalentin?":"/shop?q="+p;l+="&"+a;n.Host.launchSearch(u.query,v._navigationHelper.getSearchUrl(u.query,u.query,"SW",l,15,n.mapOSFormCode("WNSGPH")),f.useRaf)}else h?n.Host.launchSearch(u.query,v._navigationHelper.getSearchUrl(u.query,u.query,"SW",null,0),f.useRaf):(c=u.query,y&&(c=y.toLowerCase()+": "+c),n.Host.reformulateOnSuggestionClick(c,t.isSearchHomeZI,o,u.serpURLParams),n.Host.setFocusInSearchBox(null,o+".click"))};f.reactKey=o+u.query;l.push(f)},c=0,a=u.quickAnswers;c<a.length;c++)w=a[c],p(w);e(r,l,undefined)},t}();n.QuickSearchSuggestionsParser=r})(WSB||(WSB={}))